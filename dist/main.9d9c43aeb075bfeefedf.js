!function(t){function e(e){for(var s,c,r=e[0],a=e[1],d=e[2],u=0,h=[];u<r.length;u++)c=r[u],Object.prototype.hasOwnProperty.call(i,c)&&i[c]&&h.push(i[c][0]),i[c]=0;for(s in a)Object.prototype.hasOwnProperty.call(a,s)&&(t[s]=a[s]);for(l&&l(e);h.length;)h.shift()();return o.push.apply(o,d||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],s=!0,r=1;r<n.length;r++){var a=n[r];0!==i[a]&&(s=!1)}s&&(o.splice(e--,1),t=c(c.s=n[0]))}return t}var s={},i={0:0},o=[];function c(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=t,c.c=s,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)c.d(n,s,function(e){return t[e]}.bind(null,s));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="";var r=window.webpackJsonp=window.webpackJsonp||[],a=r.push.bind(r);r.push=e,r=r.slice();for(var d=0;d<r.length;d++)e(r[d]);var l=a;o.push([257,1]),n()}({257:function(t,e,n){n(258),t.exports=n(447)},444:function(t,e,n){},446:function(t,e,n){var s={"./af":122,"./af.js":122,"./ar":123,"./ar-dz":124,"./ar-dz.js":124,"./ar-kw":125,"./ar-kw.js":125,"./ar-ly":126,"./ar-ly.js":126,"./ar-ma":127,"./ar-ma.js":127,"./ar-sa":128,"./ar-sa.js":128,"./ar-tn":129,"./ar-tn.js":129,"./ar.js":123,"./az":130,"./az.js":130,"./be":131,"./be.js":131,"./bg":132,"./bg.js":132,"./bm":133,"./bm.js":133,"./bn":134,"./bn-bd":135,"./bn-bd.js":135,"./bn.js":134,"./bo":136,"./bo.js":136,"./br":137,"./br.js":137,"./bs":138,"./bs.js":138,"./ca":139,"./ca.js":139,"./cs":140,"./cs.js":140,"./cv":141,"./cv.js":141,"./cy":142,"./cy.js":142,"./da":143,"./da.js":143,"./de":144,"./de-at":145,"./de-at.js":145,"./de-ch":146,"./de-ch.js":146,"./de.js":144,"./dv":147,"./dv.js":147,"./el":148,"./el.js":148,"./en-au":149,"./en-au.js":149,"./en-ca":150,"./en-ca.js":150,"./en-gb":151,"./en-gb.js":151,"./en-ie":152,"./en-ie.js":152,"./en-il":153,"./en-il.js":153,"./en-in":154,"./en-in.js":154,"./en-nz":155,"./en-nz.js":155,"./en-sg":156,"./en-sg.js":156,"./eo":157,"./eo.js":157,"./es":158,"./es-do":159,"./es-do.js":159,"./es-mx":160,"./es-mx.js":160,"./es-us":161,"./es-us.js":161,"./es.js":158,"./et":162,"./et.js":162,"./eu":163,"./eu.js":163,"./fa":164,"./fa.js":164,"./fi":165,"./fi.js":165,"./fil":166,"./fil.js":166,"./fo":167,"./fo.js":167,"./fr":168,"./fr-ca":169,"./fr-ca.js":169,"./fr-ch":170,"./fr-ch.js":170,"./fr.js":168,"./fy":171,"./fy.js":171,"./ga":172,"./ga.js":172,"./gd":173,"./gd.js":173,"./gl":174,"./gl.js":174,"./gom-deva":175,"./gom-deva.js":175,"./gom-latn":176,"./gom-latn.js":176,"./gu":177,"./gu.js":177,"./he":178,"./he.js":178,"./hi":179,"./hi.js":179,"./hr":180,"./hr.js":180,"./hu":181,"./hu.js":181,"./hy-am":182,"./hy-am.js":182,"./id":183,"./id.js":183,"./is":184,"./is.js":184,"./it":185,"./it-ch":186,"./it-ch.js":186,"./it.js":185,"./ja":187,"./ja.js":187,"./jv":188,"./jv.js":188,"./ka":189,"./ka.js":189,"./kk":190,"./kk.js":190,"./km":191,"./km.js":191,"./kn":192,"./kn.js":192,"./ko":193,"./ko.js":193,"./ku":194,"./ku.js":194,"./ky":195,"./ky.js":195,"./lb":196,"./lb.js":196,"./lo":197,"./lo.js":197,"./lt":198,"./lt.js":198,"./lv":199,"./lv.js":199,"./me":200,"./me.js":200,"./mi":201,"./mi.js":201,"./mk":202,"./mk.js":202,"./ml":203,"./ml.js":203,"./mn":204,"./mn.js":204,"./mr":205,"./mr.js":205,"./ms":206,"./ms-my":207,"./ms-my.js":207,"./ms.js":206,"./mt":208,"./mt.js":208,"./my":209,"./my.js":209,"./nb":210,"./nb.js":210,"./ne":211,"./ne.js":211,"./nl":212,"./nl-be":213,"./nl-be.js":213,"./nl.js":212,"./nn":214,"./nn.js":214,"./oc-lnc":215,"./oc-lnc.js":215,"./pa-in":216,"./pa-in.js":216,"./pl":217,"./pl.js":217,"./pt":218,"./pt-br":219,"./pt-br.js":219,"./pt.js":218,"./ro":220,"./ro.js":220,"./ru":221,"./ru.js":221,"./sd":222,"./sd.js":222,"./se":223,"./se.js":223,"./si":224,"./si.js":224,"./sk":225,"./sk.js":225,"./sl":226,"./sl.js":226,"./sq":227,"./sq.js":227,"./sr":228,"./sr-cyrl":229,"./sr-cyrl.js":229,"./sr.js":228,"./ss":230,"./ss.js":230,"./sv":231,"./sv.js":231,"./sw":232,"./sw.js":232,"./ta":233,"./ta.js":233,"./te":234,"./te.js":234,"./tet":235,"./tet.js":235,"./tg":236,"./tg.js":236,"./th":237,"./th.js":237,"./tk":238,"./tk.js":238,"./tl-ph":239,"./tl-ph.js":239,"./tlh":240,"./tlh.js":240,"./tr":241,"./tr.js":241,"./tzl":242,"./tzl.js":242,"./tzm":243,"./tzm-latn":244,"./tzm-latn.js":244,"./tzm.js":243,"./ug-cn":245,"./ug-cn.js":245,"./uk":246,"./uk.js":246,"./ur":247,"./ur.js":247,"./uz":248,"./uz-latn":249,"./uz-latn.js":249,"./uz.js":248,"./vi":250,"./vi.js":250,"./x-pseudo":251,"./x-pseudo.js":251,"./yo":252,"./yo.js":252,"./zh-cn":253,"./zh-cn.js":253,"./zh-hk":254,"./zh-hk.js":254,"./zh-mo":255,"./zh-mo.js":255,"./zh-tw":256,"./zh-tw.js":256};function i(t){var e=o(t);return n(e)}function o(t){if(!n.o(s,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return s[t]}i.keys=function(){return Object.keys(s)},i.resolve=o,t.exports=i,i.id=446},447:function(t,e,n){"use strict";n.r(e);n(444);var s=function(t,e,n,s){return new(n||(n=Promise))((function(i,o){function c(t){try{a(s.next(t))}catch(t){o(t)}}function r(t){try{a(s.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,r)}a((s=s.apply(t,e||[])).next())}))};var i=function(t,e,n,s){return new(n||(n=Promise))((function(i,o){function c(t){try{a(s.next(t))}catch(t){o(t)}}function r(t){try{a(s.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,r)}a((s=s.apply(t,e||[])).next())}))};class o{constructor(){this.db=Y.db}renderDbInfo(){return i(this,void 0,void 0,(function*(){this.db.getDbInfoAsync().then(t=>{const e=document.querySelector(".info");e.innerHTML="";const n=document.createElement("div");n.className="info-title",n.textContent="DB info:",e.append(n),Object.keys(t).forEach(n=>{const s=t[n],i=document.createElement("div");i.className="info-notion",i.textContent=`${n} ${s}`,e.append(i)})}).catch(console.error)}))}deselectMenu(){const t=document.querySelector(".menu-wrapper").children;for(let e of t)for(let t of e.children)t.classList.remove("active");const e=document.querySelector(".header-container").children;for(let t of e)for(let e of t.children)e.classList.remove("active")}}var c=function(t,e,n,s){return new(n||(n=Promise))((function(i,o){function c(t){try{a(s.next(t))}catch(t){o(t)}}function r(t){try{a(s.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,r)}a((s=s.apply(t,e||[])).next())}))};class r extends o{constructor(t){super(),t&&(r.referrer=t)}renderAsync(){return c(this,void 0,void 0,(function*(){(yield this.db.checkAuthStateAsync())?Y.render("account"):this.renderLoginForm()}))}static applyCredentialsAsync(t){return c(this,void 0,void 0,(function*(){this.user=yield t.getUserAsync(),r.loginAnchor.textContent=this.user.login,r.loginAnchor.onclick=t=>Y.render("login"),r.loginImage.title="Выйти из учетной записи",r.loginImage.style.transform="scale(1,1)",r.loginImage.addEventListener("click",e=>this.logOut(t)),this.referrer?Y.render(this.referrer):Y.render("home")}))}highlightMenu(){super.deselectMenu();const t=document.querySelector(".login-wrapper").children;for(let e of t)!e.classList.contains("active")&&e.classList.add("active")}registerActionAsync(){return c(this,void 0,void 0,(function*(){Y.render("register")}))}loginActionAsync(){return c(this,void 0,void 0,(function*(){const t=document.getElementById("login"),e=document.getElementById("password"),n=document.querySelector(".login-input-group span"),s=document.querySelector(".login-input-group .loading");if(n.style.display="none",s.style.display="block",t.value&&e.value)try{yield this.db.authenticateAsync(t.value,e.value),(yield this.db.checkAuthStateAsync())&&(yield r.applyCredentialsAsync(this.db))}catch(t){e.value="",n.textContent=t,setTimeout(t=>n.style.opacity="1",50),setTimeout(t=>n.style.opacity="0",3e3)}s.style.display="none",n.style.display="block"}))}static logOut(t){t.logOutAsync(),this.loginAnchor.textContent="login",this.loginAnchor.title="Войти в учетную запись",this.loginImage.style.transform="scale(-1,-1)",Y.render("home")}renderLoginForm(){document.querySelector(".location").textContent="login",r.loginAnchor.textContent="login",r.loginAnchor.onclick=t=>Y.render("login");const t=document.createElement("button");t.className="btn",t.textContent="Log in",t.addEventListener("click",t=>this.loginActionAsync());const e=document.createElement("a");e.addEventListener("click",t=>this.registerActionAsync()),e.textContent="Register";const n=document.createElement("div");n.className="input-footer",n.append(e),n.append(t);const s=document.createElement("span");s.textContent="notice";const i=document.createElement("div");i.className="loading";const o=document.createElement("input");o.id="password",o.type="password",o.placeholder="password",o.addEventListener("keydown",t=>"Enter"===t.key&&this.loginActionAsync());const c=document.createElement("input");c.id="login",c.type="text",c.placeholder="login",c.addEventListener("keydown",t=>"Enter"===t.key&&this.loginActionAsync());const a=document.createElement("div");a.textContent="Specify your credentials below:";const d=document.createElement("div");d.className="login-input-group",d.append(a),d.append(c),d.append(o),d.append(s),d.append(i),d.append(n);const l=document.createElement("div");l.className="login-card",l.append(d);const u=document.querySelector(".main-field");u.innerHTML="",u.append(l),this.highlightMenu(),c.focus()}}r.loginAnchor=document.querySelector(".login-wrapper a"),r.loginImage=document.querySelector(".login-wrapper i");var a=function(t,e,n,s){return new(n||(n=Promise))((function(i,o){function c(t){try{a(s.next(t))}catch(t){o(t)}}function r(t){try{a(s.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,r)}a((s=s.apply(t,e||[])).next())}))};class d extends o{renderAsync(){return a(this,void 0,void 0,(function*(){document.querySelector(".location").textContent="home";const t=this.constructTitle(),e=this.constructInputField(),n=this.constructAnswerField(),s=document.createElement("div");s.className="search-wrapper",s.append(t),s.append(e),s.append(n);const i=document.querySelector(".main-field");i.innerHTML="",i.append(s),this.renderDbInfo(),this.highlightMenu(),document.getElementById("input").focus()}))}highlightMenu(){super.deselectMenu();const t=document.querySelector("#menu-home").children;for(let e of t)!e.classList.contains("active")&&e.classList.add("active")}constructTitle(){const t=document.createElement("h1");t.textContent="Learning parlour";const e=document.createElement("div");e.innerHTML="Input English word or a particle of the word.<br /> Use either English or Russian letters.";const n=document.createElement("div");n.className="title-content",n.append(t),n.append(e);const s=document.createElement("div");s.className="logo";const i=document.createElement("div");return i.className="title-wrapper",i.append(s),i.append(n),i}constructInputField(){const t=document.createElement("input");t.type="text",t.id="input",t.placeholder="input your query",t.addEventListener("keydown",t=>"Enter"===t.key&&this.search()),t.addEventListener("input",t=>a(this,void 0,void 0,(function*(){const e=t.target.value.trim().toLowerCase();if(e.length>1)try{const t=yield this.db.searchWordsAsync(e);return void(t.length>0&&(this.instantSearch.innerHTML="",t.forEach(t=>{const n=document.createElement("div"),s=`${t.notion} ${t.ipa}<br>${t.meaning}`;n.innerHTML=s.replace(e,`<font color='red'>${"to"===e?"to&nbsp;":e}</font>`),n.addEventListener("click",e=>this.search(t.notion)),this.instantSearch.append(n)}),this.instantSearch.style.visibility="visible",setTimeout(()=>this.instantSearch.style.opacity="1",0)))}catch(t){this.instantSearch.style.opacity="0",setTimeout(()=>this.instantSearch.style.visibility="hidden",500)}else this.instantSearch.style.opacity="0",setTimeout(()=>this.instantSearch.style.visibility="hidden",0)})));const e=document.createElement("button");e.textContent="Search",e.addEventListener("click",t=>this.search());const n=document.createElement("div");n.className="input-group",n.append(t),n.append(e);const s=document.createElement("div");s.className="summary",s.textContent="Result";const i=document.createElement("div");i.className="loading";const o=document.createElement("div");o.className="instant-wrapper",this.instantSearch=o;const c=document.createElement("div");return c.className="input-wrapper",c.append(n),c.append(s),c.append(i),c.append(o),c}constructAnswerField(){const t=document.createElement("div");return t.className="answer-wrapper",t}search(t){this.instantSearch.style.opacity="0",setTimeout(()=>this.instantSearch.style.visibility="hidden",500);const e=document.querySelector(".input-group input");if(""!==e.value.trim()||""!==t){const n=document.querySelector(".answer-wrapper"),s=document.querySelector(".summary"),i=document.querySelector(".loading");n.textContent="",i.style.display="flex",s.style.display="none";const o=t||e.value.trim().toLowerCase();this.db.searchWordsAsync(o).then(t=>{s.textContent="entries: "+t.length,t.forEach(t=>{const e=document.createElement("div");e.className="answer-entry";const s=document.createElement("div");s.className="notion",s.innerHTML=t.notion.includes(o)?`<font>${t.notion.split(o)[0]}<font color="red">${o}</font>${t.notion.split(o)[1]}</font>`:t.notion;const i=document.createElement("div");i.className="ipa",i.textContent=t.ipa;const c=document.createElement("div");c.className="meaning",c.innerHTML=t.meaning.includes(o)?`<b>${t.meaning.split(o)[0]}<font color="red">${o}</font>${t.meaning.split(o)[1]}</b>`:t.meaning;const r=document.createElement("div");r.className="definition",r.append(s),r.append(i),r.append(c);const a=document.createElement("div");a.className="example",a.textContent=t.example;const d=document.createElement("div");d.className="addDate",d.textContent=t.addDate,e.append(r),e.append(a),e.append(d),n.append(e)})}).catch(t=>{s.textContent="entries: "+t.message}).finally(()=>{i.style.display="none",s.style.display="flex",e.placeholder=o,e.value=""})}}}var l=function(t,e,n,s){return new(n||(n=Promise))((function(i,o){function c(t){try{a(s.next(t))}catch(t){o(t)}}function r(t){try{a(s.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,r)}a((s=s.apply(t,e||[])).next())}))};class u{constructor(){this.db=Y.db}renderAsync(){return l(this,void 0,void 0,(function*(){const t=this.constructTrainingZone(),e=document.createElement("div");e.className="training-field",e.append(...t);const n=document.createElement("div");n.className="training-field-wrapper",n.append(e);const s=document.createElement("div");s.className="training-wrapper";const i=this.constructPageTitles();s.append(...i,n);const o=document.querySelector(".main-field");o.innerHTML="",o.append(s),this.highlightMenu()}))}constructProgressInfo(){const t=this.constructQuickSearch(),e=document.createElement("a");e.textContent="Show quick search",e.className="quick-search-toggle",e.addEventListener("click",n=>{t.classList.toggle("hidden"),e.textContent="Show quick search",t.classList.contains("hidden")?this.quickSearchBtn.style.visibility="hidden":(e.textContent="Hide quick search",this.quickSearchBtn.style.visibility="visible",this.quickInput.placeholder="",this.quickInput.value="",this.quickInput.focus())});const n=document.createElement("div");n.className="quick-search-loading",this.quickSearchLoading=n;const s=document.createElement("div");s.textContent="Correct: 0",this.correctDiv=s;const i=document.createElement("div");i.textContent="Wrong: 0",this.wrongDiv=i;const o=document.createElement("div");o.textContent="Success: 0%",this.successDiv=o;const c=document.createElement("div");c.id="hint",this.indicatorDiv=c;const r=document.createElement("a");r.textContent="pass over",r.addEventListener("click",t=>this.passOver());const a=document.createElement("div");a.style.marginLeft="auto",a.append(r);const d=document.createElement("div");return d.className="progress-info",d.append(e),d.append(n),d.append(t),d.append(s),d.append(i),d.append(o),d.append(c),d.append(a),d}constructTrainingFieldTitle(){const t=document.createElement("div");t.className="title-left",t.textContent="Query: 0",this.leftDiv=t;const e=document.createElement("div");e.className="title-right",e.textContent="To go: 0",this.rightDiv=e;const n=document.createElement("div");return n.className="training-field-title",n.append(t),n.append(e),n}constructTrainingFieldWorkspace(){const t=document.createElement("div");t.className="training-field-issue",this.issueDiv=t;const e=document.createElement("div");e.className="hint",this.hintDiv=e;const n=document.createElement("input");n.type="text",n.addEventListener("keydown",t=>{"Enter"===t.key&&this.handleSubmit(),t.ctrlKey&&"Enter"===t.key&&this.passOver()}),this.input=n;const s=document.createElement("button");s.className="btn",s.textContent="Submit",s.addEventListener("click",t=>this.handleSubmit());const i=document.createElement("div");i.className="training-field-input",i.append(e),i.append(n),i.append(s);const o=document.createElement("div");o.className="issue",this.answerIssue=o;const c=document.createElement("div");c.className="answer",this.answerAnswer=c;const r=document.createElement("div");r.className="training-field-answer",r.append(o),r.append(c);const a=document.createElement("div");return a.className="training-field-workspace",a.append(t),a.append(i),a.append(r),a}deselectMenu(){const t=document.querySelector(".menu-wrapper").children;for(let e of t)for(let t of e.children)t.classList.remove("active");const e=document.querySelector(".header-container").children;for(let t of e)for(let e of t.children)e.classList.remove("active")}passOver(){this.score(),setTimeout(()=>this.applyNewNotionAsync(),300)}handleSubmit(){this.setHandler.assess(this.input.value)?this.score():(this.setHandler.incrementWrong(),this.setHandler.enqueue(),this.input.placeholder=this.input.value,this.blink(!1)),setTimeout(()=>this.applyNewNotionAsync(),300)}applyNewNotionAsync(){return l(this,void 0,void 0,(function*(){yield this.setHandler.nextAsync(),this.correctDiv.textContent="Correct: "+this.setHandler.Correct,this.wrongDiv.textContent="Wrong: "+this.setHandler.Wrong,this.successDiv.textContent=`Success: ${Math.round(this.setHandler.Rate)}%`,this.leftDiv.textContent="Query: "+this.setHandler.NotionId,this.rightDiv.textContent="To go: "+this.setHandler.Count,this.issueDiv.textContent=this.setHandler.Issue,this.answerIssue.textContent=this.setHandler.PreviousIssue,this.answerAnswer.textContent=this.setHandler.PreviousSolution,this.indicatorDiv.style.backgroundImage="none",this.input.value="",this.input.focus()}))}blink(t){const e=t?"darkgoldenrod":"lightcoral",n=t?"CORRECT":"WRONG";this.indicatorDiv.style.color=e,this.indicatorDiv.textContent=n,this.indicatorDiv.style.opacity="1",this.input.style.boxShadow="0 0 10px "+e,setTimeout(()=>{this.indicatorDiv.style.opacity="0",this.input.style.boxShadow="unset",!t&&setTimeout(()=>{this.indicatorDiv.style.opacity="1",this.input.style.boxShadow="0 0 10px "+e,setTimeout(()=>{this.indicatorDiv.style.opacity="0",this.input.style.boxShadow="unset"},300)},300)},t?1e3:300)}score(){this.setHandler.incrementCorrect(),this.input.placeholder="",this.blink(!0),this.setHandler.scoreAsync()}constructQuickSearch(){const t=document.createElement("input");t.addEventListener("keypress",t=>"Enter"===t.key&&this.findQuickSearch()),this.quickInput=t;const e=document.createElement("button");e.style.visibility="hidden",e.className="btn",e.textContent="FIND",e.addEventListener("click",t=>this.findQuickSearch()),this.quickSearchBtn=e;const n=document.createElement("div");n.className="quick-result-wrapper hidden",this.quickResult=n;const s=document.querySelector(".main-field");s.removeEventListener("click",t=>!n.classList.contains("hidden")&&n.classList.add("hidden")),s.addEventListener("click",t=>!n.classList.contains("hidden")&&n.classList.add("hidden"));const i=document.createElement("div");return i.className="quick-search-wrapper hidden",i.append(t,e,n),i}findQuickSearch(){const t=this.quickInput.value.trim().toLowerCase();t.length>0&&(this.quickSearchLoading.style.opacity="1",this.setHandler.findAsync(t).then(t=>{this.quickResult.innerHTML="",t.forEach(t=>{const e=document.createElement("div");e.className="quick-result-entry",e.innerHTML=`${t.notion} ${t.ipa} ${t.meaning}`,this.quickResult.append(e)}),this.quickResult.classList.contains("hidden")&&this.quickResult.classList.toggle("hidden"),this.quickSearchLoading.style.opacity="0"}).catch(t=>{this.quickInput.placeholder="nothing found",this.quickInput.value="",this.quickSearchLoading.style.opacity="0"}))}}var h=function(t,e,n,s){return new(n||(n=Promise))((function(i,o){function c(t){try{a(s.next(t))}catch(t){o(t)}}function r(t){try{a(s.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,r)}a((s=s.apply(t,e||[])).next())}))};class p{constructor(t){this.db=t,this.correct=0,this.wrong=0,this.round=1}get Count(){return this.set.length}get Round(){return this.round}get Correct(){return this.correct}get Wrong(){return this.wrong}get NotionId(){return this.currentNotion.id.toString()}get Issue(){var t;return null===(t=this.currentNotion)||void 0===t?void 0:t.issue}get Hint(){return""}get Solution(){var t;return null===(t=this.currentNotion)||void 0===t?void 0:t.solution}get PreviousIssue(){var t;return null===(t=this.previousNotion)||void 0===t?void 0:t.issue}get PreviousSolution(){var t;return null===(t=this.previousNotion)||void 0===t?void 0:t.solution}get PreviousIPA(){var t;return null===(t=this.previousNotion)||void 0===t?void 0:t.ipa}get PreviousExample(){var t;return null===(t=this.previousNotion)||void 0===t?void 0:t.example}get Examples(){let t="";return this.set.forEach(e=>e.example&&(t+=e.example.replace(e.issue,`<font color='black' style='font-weight:500'>${e.issue}</font>`)+" ")),t}get Rate(){return this.correct||this.wrong?Math.round((0|this.correct)/((0|this.correct)+(0|this.wrong))*100):0}nextAsync(){return h(this,void 0,void 0,(function*(){!this.userName&&(this.userName=(yield this.db.getUserAsync()).login)}))}enqueue(){this.set.push(this.currentNotion)}incrementWrong(){++this.wrong}incrementCorrect(){++this.correct}assess(t){return t.trim().toLowerCase()===this.Solution.trim().toLowerCase()}findAsync(t){return h(this,void 0,void 0,(function*(){return yield this.db.searchWordsAsync(t)}))}}const m=t=>{for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t};var y=function(t,e,n,s){return new(n||(n=Promise))((function(i,o){function c(t){try{a(s.next(t))}catch(t){o(t)}}function r(t){try{a(s.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,r)}a((s=s.apply(t,e||[])).next())}))};class v extends p{scoreAsync(){return y(this,void 0,void 0,(function*(){this.db.scoreGeneralsForAsync(this.userName,this.NotionId)}))}nextAsync(){const t=Object.create(null,{nextAsync:{get:()=>super.nextAsync}});return y(this,void 0,void 0,(function*(){yield t.nextAsync.call(this),this.set||(this.set=yield this.db.getGeneralsForAsync(this.userName),m(this.set)),this.previousNotion=this.currentNotion,this.currentNotion=this.set.shift()}))}}var f=function(t,e,n,s){return new(n||(n=Promise))((function(i,o){function c(t){try{a(s.next(t))}catch(t){o(t)}}function r(t){try{a(s.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,r)}a((s=s.apply(t,e||[])).next())}))};class g extends u{renderAsync(){const t=Object.create(null,{renderAsync:{get:()=>super.renderAsync}});return f(this,void 0,void 0,(function*(){if(!(yield this.db.checkAuthStateAsync()))throw new Error("generals:401:not-authorized");this.setHandler=new v(this.db),yield t.renderAsync.call(this),yield this.applyNewNotionAsync()}))}constructPageTitles(){const t=document.createElement("div");t.className="training-title",t.textContent="general vocabulary";const e=document.createElement("div");return e.className="training-task",e.textContent="fill in blanks with appropriate notion",[t,e]}constructTrainingZone(){return[this.constructProgressInfo(),this.constructTrainingFieldTitle(),this.constructTrainingFieldWorkspace()]}highlightMenu(){this.deselectMenu();const t=document.querySelector("#menu-generals").children;for(let e of t)!e.classList.contains("active")&&e.classList.add("active");document.querySelector(".location").textContent="generals"}}var w=function(t,e,n,s){return new(n||(n=Promise))((function(i,o){function c(t){try{a(s.next(t))}catch(t){o(t)}}function r(t){try{a(s.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,r)}a((s=s.apply(t,e||[])).next())}))};class b extends o{renderAsync(){return w(this,void 0,void 0,(function*(){document.querySelector(".location").textContent="register";const t=document.createElement("button");t.className="btn",t.textContent="Register",t.addEventListener("click",t=>this.registerActionAsync());const e=document.createElement("a");e.addEventListener("click",t=>this.loginActionAsync()),e.textContent="Log in";const n=document.createElement("div");n.className="input-footer",n.append(e),n.append(t);const s=document.createElement("span");s.textContent="notice";const i=document.createElement("div");i.className="loading";const o=document.createElement("input");o.id="password",o.type="password",o.placeholder="password",o.addEventListener("keydown",t=>"Enter"===t.key&&this.registerActionAsync());const c=document.createElement("input");c.id="login",c.type="text",c.placeholder="login",c.addEventListener("keydown",t=>"Enter"===t.key&&this.registerActionAsync());const r=document.createElement("div");r.textContent="Specify your credentials below:";const a=document.createElement("div");a.className="login-input-group",a.append(r),a.append(c),a.append(o),a.append(s),a.append(i),a.append(n);const d=document.createElement("div");d.className="login-card",d.append(a);const l=document.querySelector(".main-field");l.innerHTML="",l.append(d),this.highlightMenu(),c.focus()}))}highlightMenu(){super.deselectMenu();const t=document.querySelector(".login-wrapper").children;for(let e of t)!e.classList.contains("active")&&e.classList.add("active")}registerActionAsync(){return w(this,void 0,void 0,(function*(){const t=document.getElementById("login"),e=document.getElementById("password"),n=document.querySelector(".login-input-group span"),s=document.querySelector(".login-input-group .loading");if(n.style.display="none",s.style.display="block",t.value&&e.value)try{yield this.db.registerAsync(t.value,e.value),yield this.db.authenticateAsync(t.value,e.value),(yield this.db.checkAuthStateAsync())&&(yield r.applyCredentialsAsync(this.db))}catch(t){e.value="",n.textContent=t,setTimeout(t=>n.style.opacity="1",50),setTimeout(t=>n.style.opacity="0",3e3)}s.style.display="none",n.style.display="block"}))}loginActionAsync(){return w(this,void 0,void 0,(function*(){Y.render("login")}))}}var x=n(0),E=function(t,e,n,s){return new(n||(n=Promise))((function(i,o){function c(t){try{a(s.next(t))}catch(t){o(t)}}function r(t){try{a(s.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,r)}a((s=s.apply(t,e||[])).next())}))};class A extends p{constructor(){super(...arguments),this.today=[],this.last7days=[],this.last30days=[],this.last120days=[]}get Count(){return this.currentSet.length+1}scoreAsync(){return E(this,void 0,void 0,(function*(){}))}nextAsync(){const t=Object.create(null,{nextAsync:{get:()=>super.nextAsync}});return E(this,void 0,void 0,(function*(){if(yield t.nextAsync.call(this),!this.set){this.set=yield this.db.getWordsForAsync(this.userName);const t=this.findMaxDate(this.set);this.set.forEach(e=>{switch(t.diff(x(e.addDate,"DD.MM.YYYY"),"days")){case 3:case 7:this.last7days.push(e);break;case 14:case 30:this.last30days.push(e);break;case 60:case 120:this.last120days.push(e);break;default:this.today.push(e)}}),this.currentSet=this.today.concat(),m(this.currentSet)}if(0===this.currentSet.length){switch(this.round){case 1:this.currentSet=this.today.concat(this.last7days);break;case 2:this.currentSet=this.today.concat(this.last7days.concat(this.last30days));break;case 3:this.currentSet=this.today.concat(this.last7days.concat(this.last30days.concat(this.last120days)));break;default:throw new Error("Finish")}m(this.currentSet),++this.round}this.previousNotion=this.currentNotion,this.currentNotion=this.currentSet.shift()}))}enqueue(){this.currentSet.push(this.currentNotion)}assess(t){return t.trim().toLowerCase()===this.Issue.trim().toLowerCase()}findMaxDate(t){let e=x("01.01.1970","DD.MM.YYYY");return t.reduce((t,e)=>{const n=x(e.addDate,"DD.MM.YYYY");return n>t?n:t},e)}}var k=function(t,e,n,s){return new(n||(n=Promise))((function(i,o){function c(t){try{a(s.next(t))}catch(t){o(t)}}function r(t){try{a(s.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,r)}a((s=s.apply(t,e||[])).next())}))};class N extends u{renderAsync(){const t=Object.create(null,{renderAsync:{get:()=>super.renderAsync}});return k(this,void 0,void 0,(function*(){if(!(yield this.db.checkAuthStateAsync()))throw new Error("words:401:not-authorized");yield t.renderAsync.call(this),this.setHandler=new A(this.db),this.applyNewNotionAsync()}))}constructPageTitles(){const t=document.createElement("div");t.className="training-title",t.textContent="words training routine";const e=document.createElement("div");return e.className="training-task",e.textContent="guess the word",[t,e]}constructTrainingZone(){return[this.constructProgressInfo(),this.constructTrainingFieldTitle(),this.constructTrainingFieldWorkspace(),this.constructExampleField()]}highlightMenu(){super.deselectMenu();const t=document.querySelector("#menu-training").children;for(let e of t)!e.classList.contains("active")&&e.classList.add("active");document.querySelector(".location").textContent="training"}applyNewNotionAsync(){return k(this,void 0,void 0,(function*(){try{yield this.setHandler.nextAsync()}catch(t){return void this.renderSummary()}this.correctDiv.textContent="Correct: "+this.setHandler.Correct,this.wrongDiv.textContent="Wrong: "+this.setHandler.Wrong,this.successDiv.textContent=`Success: ${Math.round(this.setHandler.Rate)}%`,this.leftDiv.textContent=`Query: ${this.setHandler.NotionId} ~ Round: ${this.setHandler.Round}`,this.rightDiv.textContent="To go: "+this.setHandler.Count,this.issueDiv.textContent=this.setHandler.Solution,this.answerIssue.textContent=this.setHandler.PreviousSolution,this.answerAnswer.textContent=(this.setHandler.PreviousIssue||"")+" "+(this.setHandler.PreviousIPA||""),this.exampleDiv.textContent=this.setHandler.PreviousExample,this.indicatorDiv.style.backgroundImage="none",this.indicatorDiv.style.opacity="0",this.input.value="",this.input.focus()}))}constructExampleField(){const t=document.createElement("div");this.exampleDiv=t;const e=document.createElement("div");return e.className="training-field-example",e.append(t),e}renderSummary(){const t=document.querySelector(".progress-info");t.innerHTML="";const e=document.createElement("a");e.textContent="run again",e.addEventListener("click",t=>Y.render("words"));const n=document.createElement("div");n.style.marginLeft="auto",n.append(e);const s=document.createElement("div");s.textContent="You've solved your training routine for today",t.append(s),t.append(n),this.leftDiv.textContent=`Correct: ${this.setHandler.Correct} Wrong: ${this.setHandler.Wrong} Success: ${this.setHandler.Rate}%`,this.rightDiv.textContent="Examples:";document.querySelector(".training-field-workspace").innerHTML="",this.exampleDiv.innerHTML=this.setHandler.Examples}}var j=function(t,e,n,s){return new(n||(n=Promise))((function(i,o){function c(t){try{a(s.next(t))}catch(t){o(t)}}function r(t){try{a(s.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,r)}a((s=s.apply(t,e||[])).next())}))};class C extends p{scoreAsync(){return j(this,void 0,void 0,(function*(){this.db.scoreGerundsForAsync(this.userName,this.NotionId)}))}nextAsync(){const t=Object.create(null,{nextAsync:{get:()=>super.nextAsync}});return j(this,void 0,void 0,(function*(){yield t.nextAsync.call(this),this.set||(this.set=yield this.db.getGerundsForAsync(this.userName),m(this.set)),this.previousNotion=this.currentNotion,this.currentNotion=this.set.shift()}))}}var S=function(t,e,n,s){return new(n||(n=Promise))((function(i,o){function c(t){try{a(s.next(t))}catch(t){o(t)}}function r(t){try{a(s.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,r)}a((s=s.apply(t,e||[])).next())}))};class L extends u{renderAsync(){const t=Object.create(null,{renderAsync:{get:()=>super.renderAsync}});return S(this,void 0,void 0,(function*(){if(!(yield this.db.checkAuthStateAsync()))throw new Error("gerunds:401:not-authorized");yield t.renderAsync.call(this),this.setHandler=new C(this.db),this.applyNewNotionAsync()}))}constructPageTitles(){const t=document.createElement("div");t.className="training-title",t.textContent="gerunds training";const e=document.createElement("div");return e.className="training-task",e.textContent="fill in blanks with gerund or infinitive",[t,e]}constructTrainingZone(){return[this.constructProgressInfo(),this.constructTrainingFieldTitle(),this.constructTrainingFieldWorkspace()]}highlightMenu(){this.deselectMenu();const t=document.querySelector("#menu-gerunds").children;for(let e of t)!e.classList.contains("active")&&e.classList.add("active");document.querySelector(".location").textContent="gerunds"}}var T=function(t,e,n,s){return new(n||(n=Promise))((function(i,o){function c(t){try{a(s.next(t))}catch(t){o(t)}}function r(t){try{a(s.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,r)}a((s=s.apply(t,e||[])).next())}))};class D extends p{scoreAsync(){return T(this,void 0,void 0,(function*(){this.db.scorePhrasesForAsync(this.userName,this.NotionId)}))}nextAsync(){const t=Object.create(null,{nextAsync:{get:()=>super.nextAsync}});return T(this,void 0,void 0,(function*(){yield t.nextAsync.call(this),this.set||(this.set=yield this.db.getPhrasesForAsync(this.userName),m(this.set)),this.previousNotion=this.currentNotion,this.currentNotion=this.set.shift()}))}}var P=function(t,e,n,s){return new(n||(n=Promise))((function(i,o){function c(t){try{a(s.next(t))}catch(t){o(t)}}function r(t){try{a(s.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,r)}a((s=s.apply(t,e||[])).next())}))};class q extends u{renderAsync(){const t=Object.create(null,{renderAsync:{get:()=>super.renderAsync}});return P(this,void 0,void 0,(function*(){if(!(yield this.db.checkAuthStateAsync()))throw new Error("phrases:401:not-authorized");yield t.renderAsync.call(this),this.setHandler=new D(this.db),this.applyNewNotionAsync()}))}constructPageTitles(){const t=document.createElement("div");t.className="training-title",t.textContent="phrases training";const e=document.createElement("div");return e.className="training-task",e.textContent="fill in blanks with appropriate phrase",[t,e]}constructTrainingZone(){return[this.constructProgressInfo(),this.constructTrainingFieldTitle(),this.constructTrainingFieldWorkspace()]}highlightMenu(){this.deselectMenu();const t=document.querySelector("#menu-phrases").children;for(let e of t)!e.classList.contains("active")&&e.classList.add("active");document.querySelector(".location").textContent="phrases"}}var I=function(t,e,n,s){return new(n||(n=Promise))((function(i,o){function c(t){try{a(s.next(t))}catch(t){o(t)}}function r(t){try{a(s.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,r)}a((s=s.apply(t,e||[])).next())}))};class M extends p{scoreAsync(){return I(this,void 0,void 0,(function*(){this.db.scoreIdiomsForAsync(this.userName,this.NotionId)}))}nextAsync(){const t=Object.create(null,{nextAsync:{get:()=>super.nextAsync}});return I(this,void 0,void 0,(function*(){yield t.nextAsync.call(this),this.set||(this.set=yield this.db.getIdiomsForAsync(this.userName),m(this.set)),this.previousNotion=this.currentNotion,this.currentNotion=this.set.shift()}))}}var H=function(t,e,n,s){return new(n||(n=Promise))((function(i,o){function c(t){try{a(s.next(t))}catch(t){o(t)}}function r(t){try{a(s.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,r)}a((s=s.apply(t,e||[])).next())}))};class $ extends u{renderAsync(){const t=Object.create(null,{renderAsync:{get:()=>super.renderAsync}});return H(this,void 0,void 0,(function*(){if(!(yield this.db.checkAuthStateAsync()))throw new Error("idioms:401:not-authorized");yield t.renderAsync.call(this),this.setHandler=new M(this.db),this.applyNewNotionAsync()}))}constructPageTitles(){const t=document.createElement("div");t.className="training-title",t.textContent="idioms training";const e=document.createElement("div");return e.className="training-task",e.textContent="fill in blanks with appropriate idiom",[t,e]}constructTrainingZone(){return[this.constructProgressInfo(),this.constructTrainingFieldTitle(),this.constructTrainingFieldWorkspace()]}highlightMenu(){this.deselectMenu();const t=document.querySelector("#menu-idioms").children;for(let e of t)!e.classList.contains("active")&&e.classList.add("active");document.querySelector(".location").textContent="idioms"}}var F=function(t,e,n,s){return new(n||(n=Promise))((function(i,o){function c(t){try{a(s.next(t))}catch(t){o(t)}}function r(t){try{a(s.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,r)}a((s=s.apply(t,e||[])).next())}))};class R extends p{constructor(t,e){super(t),this.category=e}get Hint(){return this.currentNotion.meaning}scoreAsync(){return F(this,void 0,void 0,(function*(){}))}nextAsync(){const t=Object.create(null,{nextAsync:{get:()=>super.nextAsync}});return F(this,void 0,void 0,(function*(){yield t.nextAsync.call(this),this.set||(this.set=yield this.db.getPhrasalsForAsync(this.category),m(this.set)),this.previousNotion=this.currentNotion,this.currentNotion=this.set.shift()}))}}var O=function(t,e,n,s){return new(n||(n=Promise))((function(i,o){function c(t){try{a(s.next(t))}catch(t){o(t)}}function r(t){try{a(s.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,r)}a((s=s.apply(t,e||[])).next())}))};class W extends u{constructPageTitles(){const t=document.createElement("div");t.className="training-title",t.textContent="phrasals training";const e=document.createElement("div");return e.className="training-task",e.textContent="select category and guess apt phrasal verb",[t,e]}constructTrainingZone(){const t=document.createElement("label");t.textContent="Select category:",t.htmlFor="select";const e=document.createElement("select");e.className="select-category",this.select=e,this.db.getCategoriesAsync().then(t=>{t.forEach(t=>{const n=document.createElement("option");n.value=t.range,n.text=t.range,e.appendChild(n)})});const n=document.createElement("button");n.className="btn",n.textContent="GO",n.addEventListener("click",t=>this.renderCategory());const s=document.createElement("div");return s.className="progress-info",s.append(t),s.append(e),s.append(n),[s]}highlightMenu(){this.deselectMenu();const t=document.querySelector("#menu-phrasals").children;for(let e of t)!e.classList.contains("active")&&e.classList.add("active");document.querySelector(".location").textContent="phrasals"}applyNewNotionAsync(){return O(this,void 0,void 0,(function*(){yield this.setHandler.nextAsync(),this.correctDiv.textContent="Correct: "+this.setHandler.Correct,this.wrongDiv.textContent="Wrong: "+this.setHandler.Wrong,this.successDiv.textContent=`Success: ${Math.round(this.setHandler.Rate)}%`,this.leftDiv.textContent="Query: "+this.setHandler.NotionId,this.rightDiv.textContent="To go: "+this.setHandler.Count,this.issueDiv.textContent=this.setHandler.Issue,this.hintDiv.textContent=this.setHandler.Hint,this.answerIssue.textContent=this.setHandler.PreviousIssue,this.answerAnswer.textContent=this.setHandler.PreviousSolution,this.indicatorDiv.style.backgroundImage="none",this.indicatorDiv.style.opacity="0",this.input.value="",this.input.focus()}))}renderCategory(){const t=this.select.value,e=this.constructProgressInfo(),n=this.constructTrainingFieldTitle(),s=this.constructTrainingFieldWorkspace(),i=document.querySelector(".training-field");i.innerHTML="",i.append(e,n,s),this.setHandler=new R(this.db,t),this.applyNewNotionAsync()}}var z=function(t,e,n,s){return new(n||(n=Promise))((function(i,o){function c(t){try{a(s.next(t))}catch(t){o(t)}}function r(t){try{a(s.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,r)}a((s=s.apply(t,e||[])).next())}))};class B extends o{constructor(){super(...arguments),this.instantRequests=[]}renderAsync(){return z(this,void 0,void 0,(function*(){this.user=yield this.db.getUserAsync(),document.querySelector(".location").textContent="account";const t=this.constructCredentialsField(),e=this.constructTodayWordsField(),n=document.createElement("div");n.className="account-field-wrapper";const s=[t];if("admin"===this.user.role){const t=this.constructDbHandlingField();s.push(t)}s.push(e),n.append(...s);const i=document.createElement("div");i.className="account-wrapper",i.append(...this.constructPageTitles(),n);const o=document.querySelector(".main-field");o.innerHTML="",o.append(i),this.highlightMenu()}))}highlightMenu(){super.deselectMenu()}constructPageTitles(){const t=document.createElement("div");t.className="account-title",t.textContent="account options";const e=document.createElement("div");return e.className="account-task",e.textContent="adjust your account settings",[t,e]}constructCredentialsField(){const t=document.createElement("div");t.textContent="User name";const e=document.createElement("input");e.value=this.user.login,this.newName=e;const n=document.createElement("div");n.className="account-info-group",n.append(t,e);const s=document.createElement("a");s.addEventListener("click",t=>this.showAlterPasswordFields()),s.textContent="Change",this.anchorNewPassword=s;const i=document.createElement("input");i.placeholder="new password",i.style.display="none",this.newPassword=i;const o=document.createElement("input");o.placeholder="confirmation",o.style.display="none",this.newPasswordConfirm=o;const c=document.createElement("div");c.className="account-password",c.append(s,i,o);const r=document.createElement("div");r.textContent="Password";const a=document.createElement("div");a.className="account-info-group",a.append(r,c);const d=document.createElement("span");d.className="message",this.messageCredentials=d;const l=document.createElement("div");l.className="account-info-group",l.append(d);const u=document.createElement("a");u.addEventListener("click",t=>Y.render("account")),u.textContent="Cancel",u.style.color="lightcoral";const h=document.createElement("button");h.className="btn",h.textContent="Submit",h.addEventListener("click",t=>this.alterCredentials());const p=document.createElement("div");p.className="account-info-group",p.append(u,h);const m=document.createElement("span");m.className="frame-title",m.textContent="user: credentials";const y=document.createElement("div");return y.className="account-info-wrapper",y.append(m,n,a,l,p),y}showAlterPasswordFields(){this.anchorNewPassword.style.display="none",this.newPassword.style.display="block",this.newPasswordConfirm.style.display="block"}constructDbHandlingField(){const t=t=>{const e=document.createElement("input");return e.id=t,e.placeholder=t,e};this.dbNotion=t("notion"),this.dbIpa=t("ipa"),this.dbMeaning=t("meaning"),this.dbExample=t("example"),this.dbExample.onkeyup=t=>{"Enter"===t.key&&this.updateNotion()};const e=()=>{this.dbNotion.value&&this.dbMeaning.value?this.submitBtn.classList.remove("disabled"):this.currentNotion||this.submitBtn.classList.add("disabled")};this.dbNotion.onkeyup=e,this.dbMeaning.onkeyup=e;const n=document.createElement("div");n.className="account-db-row",n.append(this.dbNotion,this.dbIpa,this.dbMeaning,this.dbExample);const s=document.createElement("div");s.className="account-db-group",s.id="db-controls",s.append(n),this.dbRow=s;const i=document.createElement("a");i.onclick=t=>this.showDbRow(),i.textContent="Append";const o=document.createElement("a");o.onclick=t=>this.updateNotion(),o.textContent="Submit",o.className="disabled",this.submitBtn=o;const c=document.createElement("a");c.onclick=t=>this.deleteNotion(),c.textContent="Delete",c.className="disabled",this.deleteBtn=c;const r=document.createElement("div");r.className="account-db-group",r.append(i,o,c);const a=document.createElement("div");a.className="account-instant-wrapper",this.instantSearch=a,this.instantSearch.onmouseleave=t=>this.instantSearch.style.opacity="0",this.instantSearch.onmouseenter=t=>this.instantSearch.style.opacity="1";const d=document.createElement("input");d.placeholder="find",d.onkeydown=t=>{"Escape"===t.key&&(this.instantSearch.style.opacity="0",setTimeout(()=>this.instantSearch.style.visibility="hidden",500))},d.oninput=t=>z(this,void 0,void 0,(function*(){const e=t.target.value.trim().toLowerCase();if(e.length>1){this.instantRequests.push(e);const t=this.instantRequests.length;setTimeout(()=>{if(t!==this.instantRequests.length)this.instantSearch.style.opacity="0",setTimeout(()=>this.instantSearch.style.visibility="hidden",0);else{if(d.value.trim().length<2)return;this.db.searchWordsAsync(this.instantRequests.pop()).then(t=>{this.instantRequests.length=0,t.length>0&&(this.instantSearch.innerHTML="",t.forEach(t=>{const n=document.createElement("div"),s=`${t.notion} ${t.ipa}<br>${t.meaning}`;n.innerHTML=s.replace(e,`<font color='red'>${"to"===e?"to&nbsp;":e}</font>`),n.addEventListener("click",e=>this.fillFormRow(t)),this.instantSearch.append(n)}),this.instantSearch.style.visibility="visible",setTimeout(()=>this.instantSearch.style.opacity="1",0))}).catch(t=>{this.instantSearch.style.opacity="0",setTimeout(()=>this.instantSearch.style.visibility="hidden",300)})}},300)}else this.instantSearch.style.opacity="0",setTimeout(()=>this.instantSearch.style.visibility="hidden",0)}));const l=document.createElement("div");l.className="account-db-group",l.append(d,a);const u=document.createElement("span");u.className="message",this.messageDb=u;const h=document.createElement("span");h.className="frame-title",h.textContent="admin: database";const p=document.createElement("div");return p.className="account-info-wrapper",p.style.flexGrow="1",p.append(h,l,r,u,s),p.style.backgroundColor="rgba(176, 196, 222, 0.075)",p}constructTodayWordsField(){const t=document.createElement("div");t.className="account-today-words-title",t.textContent="THE WORDS FOR TODAY:";const e=document.createElement("div");e.className="account-today-words",this.db.getWordsForAsync(this.user.login).then(t=>{t.forEach((t,n)=>{const s=document.createElement("div");s.textContent=`${n+1}. ${t.issue}`,e.append(s)})});const n=document.createElement("span");n.className="frame-title",n.textContent="user: today words";const s=document.createElement("div");return s.className="account-info-wrapper",s.style.flexGrow="1",s.append(n,t,e),s}alterCredentials(){try{const t=this.newName.value.trim().toLowerCase();if(0===t.length)throw this.newName.focus(),new Error("Provide correct login name");let e="";if("none"!==this.newPassword.style.display){const t=this.newPassword.value.trim().toLowerCase();if(0===t.length)throw this.newPassword.focus(),new Error("Provide correct password");if(t!==this.newPasswordConfirm.value.trim().toLowerCase())throw this.newPasswordConfirm.focus(),new Error("Confirmation doesn't match");e=t}this.db.alterCredentialsAsync(this.user.login,t,e).catch(t=>this.blink(this.messageCredentials,!1,t.message)).then(t=>{this.blink(this.messageCredentials,!0,"The credentials have been updated!"),setTimeout(()=>r.applyCredentialsAsync(this.db),2e3)})}catch(t){this.blink(this.messageCredentials,!1,t.message)}}blink(t,e,n){const s=e?"success":"fail";t.style.display="block",t.classList.remove("success","fail"),t.classList.add(s),t.textContent=n,setTimeout(()=>t.style.opacity="1",0),setTimeout(()=>{t.style.opacity="0",setTimeout(()=>t.style.display="none",500)},2e3)}showDbRow(){this.dbRow.style.height="fit-content",this.dbRow.style.opacity="1",this.clearCurrentNotionAsync(),this.dbNotion.focus()}fillFormRow(t){this.showDbRow(),this.currentNotion=t,this.dbNotion.value=t.notion,this.dbIpa.value=t.ipa,this.dbMeaning.value=t.meaning,this.dbExample.value=t.example,this.instantSearch.style.opacity="0",setTimeout(()=>this.instantSearch.style.visibility="hidden",500),this.submitBtn.classList.remove("disabled"),this.deleteBtn.classList.remove("disabled")}updateNotion(){if(this.submitBtn.classList.contains("disabled"))return;const t=this.dbNotion.value.includes("to ")?this.dbNotion.value.substr(3):this.dbNotion.value,e={notion:this.dbNotion.value,ipa:this.dbIpa.value,meaning:this.dbMeaning.value,example:this.dbExample.value,issue:this.dbExample.value.includes(t)?this.dbExample.value.slice(0).replace(t,`__(${this.dbMeaning.value})__`):"",solution:this.dbExample.value.includes(t)?t:""};this.currentNotion?(e.id=this.currentNotion.id,this.currentNotion.issue&&(e.issue=this.currentNotion.issue),this.currentNotion.solution&&(e.solution=this.currentNotion.solution),this.db.updateNotionAsync(e).then(t=>{this.blink(this.messageDb,!0,`The notion ${t} has successfully been updated`),this.clearCurrentNotionAsync()}).catch(t=>{const e=t.message.toLowerCase().includes("duplicate")?`The notion '${this.dbNotion.value}' is already there`:t.message;this.blink(this.messageDb,!1,e)})):this.db.createNotionAsync(e).then(t=>{this.blink(this.messageDb,!0,`The notion ${t} has successfully been appended`),this.clearCurrentNotionAsync()}).catch(t=>{const e=t.message.toLowerCase().includes("duplicate")?`The notion '${this.dbNotion.value}' is already there`:t.message;this.blink(this.messageDb,!1,e)})}deleteNotion(){this.deleteBtn.classList.contains("disabled")||confirm("Are you sure?")&&this.db.deleteNotionAsync(this.currentNotion).then(t=>{this.blink(this.messageDb,!0,`The notion '${t}' has successfully been removed from the database`),this.clearCurrentNotionAsync()}).catch(t=>this.blink(this.messageDb,!1,t.message))}clearCurrentNotionAsync(){return z(this,void 0,void 0,(function*(){this.currentNotion=void 0,this.dbNotion.value="",this.dbIpa.value="",this.dbMeaning.value="",this.dbExample.value="",!this.submitBtn.classList.contains("disabled")&&this.submitBtn.classList.toggle("disabled"),!this.deleteBtn.classList.contains("disabled")&&this.deleteBtn.classList.toggle("disabled")}))}}window.render=t=>{switch(t){case"home":window.constructor=new d;break;case"login":window.constructor=new r;break;case"register":window.constructor=new b;break;case"generals":window.constructor=new g;break;case"words":window.constructor=new N;break;case"gerunds":window.constructor=new L;break;case"phrases":window.constructor=new q;break;case"idioms":window.constructor=new $;break;case"phrasals":window.constructor=new W;break;case"account":window.constructor=new B;break;default:throw new Error(`[render]: not existing route "${t}"`)}window.constructor.renderAsync().catch(t=>{const e=!!t.message&&t.message.split(":");e&&"401"===e[1]&&(window.constructor=new r(e[0]),window.constructor.renderAsync())})},window.toggleMenu=()=>document.querySelector(".menu-wrapper").classList.toggle("menu-wrapper-visible"),window.hideMenu=()=>document.querySelector(".menu-wrapper").classList.remove("menu-wrapper-visible");var Y=e.default=window;window.db=new class{constructor(){this.backEnd="http://slimbde.atwebpages.com/"}registerAsync(t,e){return s(this,void 0,void 0,(function*(){const n=new FormData;n.append("login",t),n.append("password",e);const s=yield fetch(this.backEnd+"php-api/users",{method:"POST",body:n});yield this.checkResponseAsync(s)}))}authenticateAsync(t,e){return s(this,void 0,void 0,(function*(){try{const n=yield fetch(`${this.backEnd}php-api/users/authenticate?login=${t.trim().toLowerCase()}&password=${e}`);yield this.checkResponseAsync(n)}catch(t){if("Not found"===t.message)throw new Error("Wrong login/password")}localStorage.removeItem("user"),localStorage.setItem("user",JSON.stringify({login:t,role:"admin"===t?"admin":"user"}))}))}checkAuthStateAsync(){return s(this,void 0,void 0,(function*(){return!!localStorage.getItem("user")}))}getUserAsync(){return s(this,void 0,void 0,(function*(){const t=localStorage.getItem("user");if(t)return JSON.parse(t);throw new Error("No user has been logged in")}))}logOutAsync(){return s(this,void 0,void 0,(function*(){localStorage.removeItem("user")}))}alterCredentialsAsync(t,e,n=""){return s(this,void 0,void 0,(function*(){const s=yield fetch(`${this.backEnd}php-api/users/altercredentials?prevLogin=${t}&login=${e}&password=${n}`);yield this.checkResponseAsync(s),localStorage.removeItem("user"),localStorage.setItem("user",JSON.stringify({login:e,role:"admin"===e?"admin":"user"}))}))}searchWordsAsync(t){return s(this,void 0,void 0,(function*(){const e=yield fetch(`${this.backEnd}php-api/words/getfor?particle=${t}`);yield this.checkResponseAsync(e);return(yield e.json()).map(t=>({id:t["#"],notion:t.Word,ipa:t.IPA,meaning:t.Translation,example:t.Example,addDate:t["Add Date"]}))}))}getWordsForAsync(t){return s(this,void 0,void 0,(function*(){const e=yield fetch(`${this.backEnd}php-api/words/getsetfor?login=${t}`);yield this.checkResponseAsync(e);return(yield e.json()).map(t=>({id:t["#"],issue:t.Word,ipa:t.IPA,solution:t.Translation,example:t.Example,addDate:t["Add Date"]}))}))}getGeneralsForAsync(t){return s(this,void 0,void 0,(function*(){const e=yield fetch(`${this.backEnd}php-api/words/getgeneralsfor?login=${t}`);yield this.checkResponseAsync(e);return(yield e.json()).map(t=>({id:t["#"],issue:t.Issue,solution:t.Answer}))}))}scoreGeneralsForAsync(t,e){return s(this,void 0,void 0,(function*(){yield fetch(`${this.backEnd}php-api/words/setgeneralsfor?login=${t}&notionId=${e}`)}))}getGerundsForAsync(t){return s(this,void 0,void 0,(function*(){const e=yield fetch(`${this.backEnd}php-api/words/getgerundsfor?login=${t}`);yield this.checkResponseAsync(e);return(yield e.json()).map(t=>({id:t["#"],issue:t.Issue,solution:t.Answer}))}))}scoreGerundsForAsync(t,e){return s(this,void 0,void 0,(function*(){yield fetch(`${this.backEnd}php-api/words/setgerundsfor?login=${t}&notionId=${e}`)}))}getPhrasesForAsync(t){return s(this,void 0,void 0,(function*(){const e=yield fetch(`${this.backEnd}php-api/words/getphrasesfor?login=${t}`);yield this.checkResponseAsync(e);return(yield e.json()).map(t=>({id:t["#"],issue:t.Issue,solution:t.Answer}))}))}scorePhrasesForAsync(t,e){return s(this,void 0,void 0,(function*(){yield fetch(`${this.backEnd}php-api/words/setphrasesfor?login=${t}&notionId=${e}`)}))}getIdiomsForAsync(t){return s(this,void 0,void 0,(function*(){const e=yield fetch(`${this.backEnd}php-api/words/getidiomsfor?login=${t}`);yield this.checkResponseAsync(e);return(yield e.json()).map(t=>({id:t["#"],issue:t.Issue,solution:t.Answer}))}))}scoreIdiomsForAsync(t,e){return s(this,void 0,void 0,(function*(){yield fetch(`${this.backEnd}php-api/words/setidiomsfor?login=${t}&notionId=${e}`)}))}getCategoriesAsync(){return s(this,void 0,void 0,(function*(){const t=yield fetch(this.backEnd+"php-api/words/getphrasalscategories");return yield this.checkResponseAsync(t),t.json()}))}getPhrasalsForAsync(t){return s(this,void 0,void 0,(function*(){const e=yield fetch(`${this.backEnd}php-api/words/getphrasalsfor?category=${t}`);yield this.checkResponseAsync(e);return(yield e.json()).map(t=>({id:t["#"],issue:t.Translation,solution:t.Phrasal,meaning:t.hint}))}))}getDbInfoAsync(){return s(this,void 0,void 0,(function*(){const t=yield fetch(this.backEnd+"php-api/users/getdbinfo");return yield this.checkResponseAsync(t),yield t.json()}))}deleteNotionAsync(t){return s(this,void 0,void 0,(function*(){const e=yield fetch(`${this.backEnd}php-api/words/${t.id}`,{method:"DELETE"});return yield this.checkResponseAsync(e),yield e.json()}))}updateNotionAsync(t){return s(this,void 0,void 0,(function*(){const e=yield fetch(this.backEnd+"php-api/words",{method:"PUT",body:JSON.stringify(t)});return yield this.checkResponseAsync(e),yield e.json()}))}createNotionAsync(t){return s(this,void 0,void 0,(function*(){const e=new FormData;e.append("notion",JSON.stringify(t));const n=yield fetch(this.backEnd+"php-api/words",{method:"POST",body:e});return yield this.checkResponseAsync(n),yield n.json()}))}checkResponseAsync(t){return s(this,void 0,void 0,(function*(){if(t.status>400)switch(t.status){case 504:throw new Error("DB is offline");default:throw new Error(yield t.json())}}))}},window.render("home"),window.db.checkAuthStateAsync().then(t=>t&&r.applyCredentialsAsync(window.db)),"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.js").then(t=>{console.log("SW registered: ",t)}).catch(t=>{console.log("SW registration failed: ",t)})})}});